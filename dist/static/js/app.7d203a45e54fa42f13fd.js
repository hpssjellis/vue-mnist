webpackJsonp([1],{0:function(e,t){},1:function(e,t){},2:function(e,t){},3:function(e,t){},CyND:function(e,t){},GK12:function(e,t){},"N/sm":function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),i=s("c/Tr"),n=s.n(i),r=s("Xxa5"),l=s.n(r),o=s("exGp"),c=s.n(o),u=s("AJaF"),d=s("d7EF"),p=s.n(d),m=s("//Fk"),h=s.n(m),v=s("Zrlr"),g=s.n(v),b=s("wxAW"),f=s.n(b),y=function(){function e(){g()(this,e),this.shuffledTrainIndex=0,this.shuffledTestIndex=0}return f()(e,[{key:"load",value:function(){var e=c()(l.a.mark(function e(){var t,s,a,i,n,r,o,c,d=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("you are in the load method of class MnistData"),t=new Image,s=document.createElement("canvas"),a=s.getContext("2d"),i=new h.a(function(e,i){t.crossOrigin="",t.onload=function(){t.width=t.naturalWidth,t.height=t.naturalHeight;var i=new ArrayBuffer(20384e4);s.width=t.width,s.height=5e3;for(var n=0;n<13;n++){var r=new Float32Array(i,784*n*5e3*4,392e4);a.drawImage(t,0,5e3*n,t.width,5e3,0,0,t.width,5e3);for(var l=a.getImageData(0,0,s.width,s.height),o=0;o<l.data.length/4;o++)r[o]=l.data[4*o]/255}d.datasetImages=new Float32Array(i),e()},console.log("you are about to load image"),t.src="https://storage.googleapis.com/learnjs-data/model-builder/mnist_images.png"}),n=fetch("https://storage.googleapis.com/learnjs-data/model-builder/mnist_labels_uint8",{mode:"arraybuffer"}),e.next=8,h.a.all([i,n]);case 8:return r=e.sent,o=p()(r,2),o[0],c=o[1],e.t0=Uint8Array,e.next=15,c.arrayBuffer();case 15:e.t1=e.sent,this.datasetLabels=new e.t0(e.t1),this.trainIndices=u.util.createShuffledIndices(55e3),this.testIndices=u.util.createShuffledIndices(1e4),this.trainImages=this.datasetImages.slice(0,4312e4),this.testImages=this.datasetImages.slice(4312e4),this.trainLabels=this.datasetLabels.slice(0,55e4),this.testLabels=this.datasetLabels.slice(55e4);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"nextTrainBatch",value:function(e){var t=this;return this.nextBatch(e,[this.trainImages,this.trainLabels],function(){return t.shuffledTrainIndex=(t.shuffledTrainIndex+1)%t.trainIndices.length,t.trainIndices[t.shuffledTrainIndex]})}},{key:"nextTestBatch",value:function(e){var t=this;return this.nextBatch(e,[this.testImages,this.testLabels],function(){return t.shuffledTestIndex=(t.shuffledTestIndex+1)%t.testIndices.length,t.testIndices[t.shuffledTestIndex]})}},{key:"nextBatch",value:function(e,t,s){for(var a=new Float32Array(784*e),i=new Uint8Array(10*e),n=0;n<e;n++){var r=s(),l=t[0].slice(784*r,784*r+784);a.set(l,784*n);var o=t[1].slice(10*r,10*r+10);i.set(o,10*n)}return{xs:u.tensor2d(a,[e,784]),labels:u.tensor2d(i,[e,10])}}}]),e}(),x=s("GOEm"),w=s.n(x),j=u.sequential(),_=void 0;j.add(u.layers.conv2d({inputShape:[28,28,1],kernelSize:5,filters:8,strides:1,activation:"relu",kernelIniliazer:"varianceScaling"})),j.add(u.layers.maxPooling2d({poolSize:[2,2],strides:[2,2]})),j.add(u.layers.conv2d({kernelSize:5,filters:16,strides:1,activation:"relu",kernelIniliazer:"varianceScaling"})),j.add(u.layers.maxPooling2d({poolSize:[2,2],strides:[2,2]})),j.add(u.layers.flatten()),j.add(u.layers.dense({units:10,kernelIniliazer:"varianceScaling",activation:"softmax"}));var k=u.train.sgd(.5);j.compile({optimizer:k,loss:"categoricalCrossentropy",metrics:["accuracy"]});var C={created:function(){},mounted:function(){this.message="Loading data ...",console.log(this.valuesCreated),this.mnist()},data:function(){return{message:"Loading data ...",lossValues:[],accuracyValues:[],batchNumber:null,predictions:[],predictionTitle:""}},methods:{train:function(){var e=this;return c()(l.a.mark(function t(){var s,a,i,n,r,o,c;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.message="Training ...",s=0;case 2:if(!(s<150)){t.next=24;break}return e.batchNumber=s,a=_.nextTrainBatch(64),i=void 0,n=void 0,s%5==0&&(i=_.nextTestBatch(1e3),n=[i.xs.reshape([1e3,28,28,1]),i.labels]),t.next=10,j.fit(a.xs.reshape([64,28,28,1]),a.labels,{batchSize:64,validationData:n,epochs:1});case 10:return r=t.sent,o=r.history.loss[0],c=r.history.acc[0],e.lossValues.push({batch:s,loss:o,set:"train"}),e.plotLoss(),null!=i&&(e.accuracyValues.push({batch:s,accuracy:c,set:"train"}),e.plotAccuracy()),a.xs.dispose(),a.labels.dispose(),null!=i&&(i.xs.dispose(),i.labels.dispose()),t.next=21,u.nextFrame();case 21:s++,t.next=2;break;case 24:e.message="Done!";case 25:case"end":return t.stop()}},t,e)}))()},load:function(){var e=this;return c()(l.a.mark(function t(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _=new y,e.next=3,_.load();case 3:case"end":return e.stop()}},t,e)}))()},mnist:function(){var e=this;return c()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.load();case 2:return t.next=4,e.train();case 4:e.showPredictions();case 5:case"end":return t.stop()}},t,e)}))()},plotAccuracy:function(){w()("#accuracyCanvas",{$schema:"https://vega.github.io/schema/vega-lite/v2.json",data:{values:this.accuracyValues},mark:{type:"line",legend:null},width:260,orient:"vertical",encoding:{x:{field:"batch",type:"quantitative"},y:{field:"accuracy",type:"quantitative"},color:{field:"set",type:"nominal",legend:null}}},{width:360})},plotLoss:function(){w()("#lossCanvas",{$schema:"https://vega.github.io/schema/vega-lite/v2.json",data:{values:this.lossValues},mark:{type:"line"},width:260,orient:"vertical",encoding:{x:{field:"batch",type:"quantitative"},y:{field:"loss",type:"quantitative"},color:{field:"set",type:"nominal",legend:null}}},{width:360})},showPredictions:function(){var e=this;return c()(l.a.mark(function t(){var s,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s=100,a=_.nextTestBatch(s),u.tidy(function(){var t=j.predict(a.xs.reshape([-1,28,28,1])),s=n()(a.labels.argMax(1).dataSync()),i=n()(t.argMax(1).dataSync());e.showTestResults(a,i,s)});case 3:case"end":return t.stop()}},t,e)}))()},showTestResults:function(e,t,s){this.predictionTitle="Predictions";var a=document.getElementById("images");console.log(a);for(var i=e.xs.shape[0],n=0;n<i;n++){var r=e.xs.slice([n,0],[1,e.xs.shape[1]]),l=document.createElement("div");l.className="pred-container";var o=document.createElement("canvas");o.setAttribute("class","predictionCanvas"),this.draw(r.flatten(),o);var c=document.createElement("div"),u=t[n],d=u===s[n];c.className="pred "+(d?"pred-correct":"pred-incorrect"),c.innerText="pred: "+u,l.appendChild(c),l.appendChild(o),a.appendChild(l)}},draw:function(e,t){t.width=28,t.height=28;for(var s=t.getContext("2d"),a=new ImageData(28,28),i=e.dataSync(),n=0;n<784;++n){var r=4*n;a.data[r+0]=255*i[n],a.data[r+1]=255*i[n],a.data[r+2]=255*i[n],a.data[r+3]=255}s.putImageData(a,0,0)}}},I={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("section",{staticClass:"section"},[s("h1",{staticClass:"title"},[e._v(e._s(e.message))]),e._v(" "),s("h2",{staticClass:"subtitle"},[s("p",{staticClass:"lead"},[e._v("\n                "+e._s("Batch: "+e.batchNumber)+"\n            ")])])]),e._v(" "),s("section",{staticClass:"section"},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column"},[s("div",{staticClass:"canvases"},[s("div",{staticClass:"label",attrs:{id:"loss-label"}},[s("p",{staticClass:"lead"},[e._v(e._s("Last loss: "+e.lossValues[e.lossValues.length-1].loss.toFixed(2)))])]),e._v(" "),s("div",{attrs:{id:"lossCanvas"}})])]),e._v(" "),s("div",{staticClass:"column"},[s("div",{staticClass:"canvases"},[s("div",{staticClass:"label",attrs:{id:"accuracy-label"}},[s("p",{staticClass:"lead"},[e._v(e._s("Last accuracy: "+(100*e.accuracyValues[e.accuracyValues.length-1].accuracy).toFixed(2)))])]),e._v(" "),s("div",{attrs:{id:"accuracyCanvas"}})])]),e._v(" "),s("div",{staticClass:"column"}),e._v(" "),s("div",{staticClass:"column"})])]),e._v(" "),s("section",{staticClass:"section"},[s("h1",{staticClass:"title"},[e._v(e._s(e.predictionTitle))]),e._v(" "),s("div",{attrs:{id:"images"}})])])},staticRenderFns:[]};var T=s("VU/8")(C,I,!1,function(e){s("YzPA")},"data-v-200f7b58",null).exports,z={mounted:function(){console.log("the component was mounted")}},S={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("section",{staticClass:"hero is-warning"},[t("div",{staticClass:"container"},[t("div",{staticClass:"hero-body"},[t("h1",{staticClass:"title"},[this._v("\n                Hi, there\n            ")]),this._v(" "),t("h2",{staticClass:"subtitle"},[this._v("\n                Let's train the famous MNIST data using Tensorflow.js and Vue.js\n            ")])])])])])}]};var A=s("VU/8")(z,S,!1,function(e){s("N/sm")},null,null).exports;s("GK12");var L={name:"App",components:{Main:T,Hero:A}},B={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("Hero"),this._v(" "),t("div",{staticClass:"container"},[t("Main")],1)],1)},staticRenderFns:[]};var V=s("VU/8")(L,B,!1,function(e){s("CyND")},null,null).exports;a.a.config.productionTip=!1,new a.a({el:"#app",components:{App:V},template:"<App/>"})},SeQP:function(e,t){e.exports={_args:[["vega-lib@3.2.1","/Users/paryal/sites/vue-mnist"]],_from:"vega-lib@3.2.1",_id:"vega-lib@3.2.1",_inBundle:!1,_integrity:"sha512-ufcPBsYyiDkyvw20lKZi/pAYFRVJNmsnpX+JyO+lvLUg2XjtChC7xNHI7htHI2AXk525F4zG/yHB2T9U97JdBQ==",_location:"/vega-lib",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"vega-lib@3.2.1",name:"vega-lib",escapedName:"vega-lib",rawSpec:"3.2.1",saveSpec:null,fetchSpec:"3.2.1"},_requiredBy:["/vega-embed"],_resolved:"https://registry.npmjs.org/vega-lib/-/vega-lib-3.2.1.tgz",_spec:"3.2.1",_where:"/Users/paryal/sites/vue-mnist",author:{name:"UW Interactive Data Lab",url:"http://idl.cs.washington.edu"},browser:{buffer:!1,canvas:!1,"canvas-prebuilt":!1,fs:!1},bugs:{url:"https://github.com/vega/vega-lib/issues"},contributors:[{name:"Jeffrey Heer",url:"http://idl.cs.washington.edu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Ryan Russell",url:"https://github.com/RussellSprouts"},{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"},{name:"Yuri Astrakhan",url:"https://github.com/nyurik"}],dependencies:{"vega-crossfilter":"2","vega-dataflow":"3","vega-encode":"2","vega-expression":"^2.3","vega-force":"2","vega-geo":"^2.2","vega-hierarchy":"^2.1","vega-loader":"2","vega-parser":"^2.5","vega-projection":"1","vega-runtime":"2","vega-scale":"^2.1","vega-scenegraph":"^2.3","vega-statistics":"^1.2","vega-transforms":"^1.2","vega-typings":"*","vega-util":"^1.7","vega-view":"^2.2","vega-view-transforms":"^1.2","vega-voronoi":"2","vega-wordcloud":"^2.1"},description:"Include Vega in projeccts using minimal dependencies.",devDependencies:{eslint:"4",rollup:"0.43","rollup-plugin-json":"2","rollup-plugin-node-resolve":"3",tape:"4",tv4:"1","uglify-js":"3"},homepage:"https://github.com/vega/vega-lib#readme","jsnext:main":"index",keywords:["vega","visualization","interaction","dataflow","library","data","d3"],license:"BSD-3-Clause",main:"build/vega.js",module:"index",name:"vega-lib",repository:{type:"git",url:"git+https://github.com/vega/vega-lib.git"},scripts:{__postpublish:"git push && git push --tags",build:"npm run rollup && bin/rollup -e",postbuild:"uglifyjs build/vega.js -c -m -o build/vega.min.js && uglifyjs build/vega-core.js -c -m -o build/vega-core.min.js",prebuild:"rm -rf build && mkdir build",prepublish:"npm run test && npm run build",rollup:"bin/rollup && bin/schema > build/vega-schema.json",test:"eslint index.js"},version:"3.2.1"}},Wriu:function(e,t){e.exports={name:"vega-lite",author:'Jeffrey Heer, Dominik Moritz, Kanit "Ham" Wongsuphasawat',version:"2.3.1",collaborators:["Kanit Wongsuphasawat <kanitw@gmail.com> (http://kanitw.yellowpigz.com)","Dominik Moritz <domoritz@cs.washington.edu> (https://www.domoritz.de)","Jeffrey Heer <jheer@uw.edu> (http://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",main:"build/src/index.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",types:"typings/vega-lite.d.ts",bin:{vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},directories:{test:"test"},scripts:{pretsc:"mkdir -p build && rm -rf build/*/** && cp package.json build/",prebuild:"mkdir -p build/site build/test-gallery",build:"npm run build:only","build:only":"tsc && cp package.json build && browserify src/index.ts -p tsify -d -s vl | exorcist build/vega-lite.js.map > build/vega-lite.js",postbuild:"node node_modules/uglify-js/bin/uglifyjs build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && npm run schema","build:examples":"npm run data && npm run build:only && npm run build:examples-only","build:examples-only":"npm run build:example && npm run build:examples-normalized","build:examples-normalized":"rm -f examples/specs/normalized/*.vl.json && scripts/build-normalized-examples","build:example":"TZ=America/Los_Angeles scripts/build-examples.sh","build:toc":"bundle exec jekyll build -q && scripts/generate-toc","build:site":"browserify site/static/main.ts -p [tsify -p site] -d | exorcist build/site/main.js.map > build/site/main.js","build:versions":"scripts/update-version.sh","build:test-gallery":"browserify test-gallery/main.ts -p [tsify -p test-gallery] -d > build/test-gallery/main.js","check:examples":"scripts/check-examples.sh","check:schema":"scripts/check-schema.sh",clean:"rm -rf build && rm -f vega-lite.* & find -E src test site examples -regex '.*\\.(js|js.map|d.ts)' -delete && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' -type f -exec rm -f {} +",data:"rsync -r node_modules/vega-datasets/data/* data",deploy:"scripts/deploy.sh","deploy:gh":"scripts/deploy-gh.sh","deploy:schema":"scripts/deploy-schema.sh",prestart:"npm run data && npm run build && scripts/index-examples",start:"nodemon -x 'npm run build:test-gallery' & browser-sync start --server --files 'build/test-gallery/main.js' --index 'test-gallery/index.html'",poststart:"rm examples/all-examples.json",preschema:"npm run prebuild",schema:"ts-json-schema-generator --path tsconfig.json --type TopLevelSpec > build/vega-lite-schema.json && npm run renameschema && cp build/vega-lite-schema.json _data/",renameschema:"scripts/rename-schema.sh",presite:"npm run prebuild && npm run data && npm run build:site && npm run build:toc && npm run build:versions && scripts/create-example-pages",site:"bundle exec jekyll serve --incremental",lint:"tslint -p .",test:"npm run build:only && npm run test:only && npm run test:runtime && npm run lint",posttest:"npm run schema && npm run data && npm run mocha:examples","test:nocompile":"npm run test:only && npm run test:runtime && npm run lint && npm run mocha:examples","test:only":"nyc --reporter=html --reporter=text-summary npm run mocha:test","test:runtime":"TZ=America/Los_Angeles wdio wdio.conf.js","test:runtime:generate":"rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true npm run test:runtime","test:debug":"tsc && mocha --recursive --debug-brk --inspect build/test","test:debug-examples":"tsc && npm run schema && mocha --recursive --debug-brk --inspect build/examples","mocha:test":"mocha --require source-map-support/register --reporter dot --recursive build/test","mocha:examples":"mocha --require source-map-support/register --reporter dot --recursive build/examples",codecov:"nyc report --reporter=json && codecov -f coverage/*.json","watch:build":"watchify src/index.ts -p tsify -v -d -s vl -o 'exorcist build/vega-lite.js.map > build/vega-lite.js'","watch:test":"nodemon -x 'npm test'",watch:"nodemon -x 'npm run build && npm run test:nocompile' # already ran schema in build"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@types/chai":"^4.1.2","@types/d3":"^4.13.0","@types/highlight.js":"^9.12.2","@types/mkdirp":"^0.5.2","@types/mocha":"^2.2.48","@types/node":"^9.4.7","@types/webdriverio":"^4.10.0",ajv:"^6.2.1","browser-sync":"^2.23.6","browserify-shim":"^3.8.14",browserify:"^16.1.1",chai:"^4.1.2",cheerio:"^1.0.0-rc.2",chromedriver:"^2.36.0",codecov:"^3.0.0",d3:"^4.13.0",exorcist:"^1.0.1","highlight.js":"^9.12.0",mkdirp:"^0.5.1",mocha:"^5.0.4",nodemon:"^1.17.1",nyc:"^11.4.1","source-map-support":"^0.5.3","svg2png-many":"^0.0.7","ts-json-schema-generator":"^0.21.0","ts-node":"^5.0.1",tsify:"^3.0.4","tslint-eslint-rules":"^5.1.0",tslint:"5.9.1",typescript:"^2.7.2","uglify-js":"^3.3.14","vega-datasets":"^1.18.0","vega-embed":"^3.1.1","vega-tooltip":"^0.6.1",vega:"^3.2.1",watchify:"^3.11.0","wdio-chromedriver-service":"^0.1.2","wdio-dot-reporter":"0.0.9","wdio-mocha-framework":"^0.5.13","wdio-static-server-service":"^1.0.1",webdriverio:"^4.12.0","yaml-front-matter":"^4.0.0"},dependencies:{"@types/json-stable-stringify":"^1.0.32","vega-typings":"^0.2.11","json-stable-stringify":"^1.0.1",tslib:"^1.9.0","vega-event-selector":"^2.0.0","vega-util":"^1.7.0",yargs:"^11.0.0"}}},YzPA:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.7d203a45e54fa42f13fd.js.map